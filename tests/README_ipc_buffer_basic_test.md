# IPC Buffer Basic Tests

## üìã –û–ø–∏—Å–∞–Ω–∏–µ
–ë–∞–∑–æ–≤—ã–µ —Ç–µ—Å—Ç—ã –¥–ª—è `ipc_buffer.h` - –ø—Ä–æ–≤–µ—Ä—è—é—Ç –æ—Å–Ω–æ–≤–Ω—É—é —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å IPC –±—É—Ñ–µ—Ä–æ–≤, –≤–∫–ª—é—á–∞—è —Å–æ–∑–¥–∞–Ω–∏–µ, –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ, —á—Ç–µ–Ω–∏–µ, –∑–∞–ø–∏—Å—å –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã–º–∏.

## üéØ –¶–µ–ª—å —Ç–µ—Å—Ç–æ–≤
–£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –≤—Å–µ –æ—Å–Ω–æ–≤–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ IPC –±—É—Ñ–µ—Ä–æ–≤ —Ä–∞–±–æ—Ç–∞—é—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –≤ –Ω–æ—Ä–º–∞–ª—å–Ω—ã—Ö —É—Å–ª–æ–≤–∏—è—Ö –∏ –ø—Ä–∞–≤–∏–ª—å–Ω–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç –æ—à–∏–±–∫–∏.

## üìä –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ç–µ—Å—Ç–æ–≤
**84 —Ç–µ—Å—Ç–∞** - –ø–æ–ª–Ω–æ–µ –ø–æ–∫—Ä—ã—Ç–∏–µ API –±—É—Ñ–µ—Ä–æ–≤

## üîß –¢–µ—Å—Ç–∏—Ä—É–µ–º—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏

### **–°–æ–∑–¥–∞–Ω–∏–µ –∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –±—É—Ñ–µ—Ä–æ–≤**
- `ipc_buffer_align_size()` - –≤—ã—Ä–∞–≤–Ω–∏–≤–∞–Ω–∏–µ —Ä–∞–∑–º–µ—Ä–æ–≤
- `ipc_buffer_create()` - —Å–æ–∑–¥–∞–Ω–∏–µ –±—É—Ñ–µ—Ä–∞
- `ipc_buffer_attach()` - –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–º—É –±—É—Ñ–µ—Ä—É

### **–û–ø–µ—Ä–∞—Ü–∏–∏ —Å –¥–∞–Ω–Ω—ã–º–∏**
- `ipc_buffer_write()` - –∑–∞–ø–∏—Å—å –¥–∞–Ω–Ω—ã—Ö
- `ipc_buffer_read()` - —á—Ç–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö
- `ipc_buffer_peek()` - –ø—Ä–æ—Å–º–æ—Ç—Ä –±–µ–∑ —á—Ç–µ–Ω–∏—è
- `ipc_buffer_skip()` - –ø—Ä–æ–ø—É—Å–∫ –∑–∞–ø–∏—Å–µ–π
- `ipc_buffer_skip_force()` - –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω—ã–π –ø—Ä–æ–ø—É—Å–∫

### **–ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏**
- `ipc_buffer_reserve_entry()` - —Ä–µ–∑–µ—Ä–≤–∏—Ä–æ–≤–∞–Ω–∏–µ –º–µ—Å—Ç–∞
- `ipc_buffer_commit_entry()` - –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –∑–∞–ø–∏—Å–∏

## üß™ –¢–∏–ø—ã —Ç–µ—Å—Ç–æ–≤

### **1. –°–æ–∑–¥–∞–Ω–∏–µ –±—É—Ñ–µ—Ä–æ–≤**
```cpp
TEST_CASE("buffer create - too small size")
TEST_CASE("buffer create - NULL memory pointer") 
TEST_CASE("buffer create - minimum valid size")
TEST_CASE("buffer create - various valid sizes")
```
**–ß—Ç–æ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç:** –ö–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å —Å–æ–∑–¥–∞–Ω–∏—è –±—É—Ñ–µ—Ä–æ–≤ —Å —Ä–∞–∑–Ω—ã–º–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏
**–ö–∞–∫ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç:** –°–æ–∑–¥–∞–µ—Ç –±—É—Ñ–µ—Ä—ã —Å —Ä–∞–∑–Ω—ã–º–∏ —Ä–∞–∑–º–µ—Ä–∞–º–∏, –ø—Ä–æ–≤–µ—Ä—è–µ—Ç —É—Å–ø–µ—Ö/–æ—à–∏–±–∫–∏
**–ó–∞—á–µ–º:** –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ API –ø—Ä–∞–≤–∏–ª—å–Ω–æ –≤–∞–ª–∏–¥–∏—Ä—É–µ—Ç –≤—Ö–æ–¥–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã

### **2. –û–ø–µ—Ä–∞—Ü–∏–∏ –∑–∞–ø–∏—Å–∏**
```cpp
TEST_CASE("write with NULL buffer")
TEST_CASE("write with NULL data") 
TEST_CASE("write with zero size")
TEST_CASE("write success case")
```
**–ß—Ç–æ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç:** –ó–∞–ø–∏—Å—å –¥–∞–Ω–Ω—ã—Ö –≤ –±—É—Ñ–µ—Ä
**–ö–∞–∫ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç:** –ü—ã—Ç–∞–µ—Ç—Å—è –∑–∞–ø–∏—Å–∞—Ç—å –¥–∞–Ω–Ω—ã–µ, –ø—Ä–æ–≤–µ—Ä—è–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç
**–ó–∞—á–µ–º:** –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –¥–∞–Ω–Ω—ã–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è

### **3. –û–ø–µ—Ä–∞—Ü–∏–∏ —á—Ç–µ–Ω–∏—è**
```cpp
TEST_CASE("read with NULL buffer")
TEST_CASE("read with NULL dest")
TEST_CASE("read success case")
```
**–ß—Ç–æ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç:** –ß—Ç–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –∏–∑ –±—É—Ñ–µ—Ä–∞
**–ö–∞–∫ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç:** –ß–∏—Ç–∞–µ—Ç –∑–∞–ø–∏—Å–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ, –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å
**–ó–∞—á–µ–º:** –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –¥–∞–Ω–Ω—ã–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –∏–∑–≤–ª–µ–∫–∞—é—Ç—Å—è

### **4. –ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏**
```cpp
TEST_CASE("reserve_entry - NULL buffer")
TEST_CASE("commit_entry - NULL buffer")
TEST_CASE("peek operations")
TEST_CASE("skip operations")
```
**–ß—Ç–æ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç:** –°–ª–æ–∂–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ —Å –±—É—Ñ–µ—Ä–æ–º
**–ö–∞–∫ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç:** –¢–µ—Å—Ç–∏—Ä—É–µ—Ç —Ä–µ–∑–µ—Ä–≤–∏—Ä–æ–≤–∞–Ω–∏–µ, –∫–æ–º–º–∏—Ç, –ø—Ä–æ—Å–º–æ—Ç—Ä, –ø—Ä–æ–ø—É—Å–∫
**–ó–∞—á–µ–º:** –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –ø—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ —Ä–∞–±–æ—Ç–∞—é—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ

### **5. –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫**
```cpp
TEST_CASE("error structure verification")
TEST_CASE("boundary conditions")
```
**–ß—Ç–æ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç:** –ö–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–π –æ–± –æ—à–∏–±–∫–∞—Ö
**–ö–∞–∫ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç:** –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –ø–æ–ª—è —Å—Ç—Ä—É–∫—Ç—É—Ä –æ—à–∏–±–æ–∫
**–ó–∞—á–µ–º:** –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –æ—à–∏–±–∫–∏ —Å–æ–¥–µ—Ä–∂–∞—Ç –ø–æ–ª–µ–∑–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é

## üöÄ –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### **–ë–∞–∑–æ–≤–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ**
```cpp
// –°–æ–∑–¥–∞–Ω–∏–µ –±—É—Ñ–µ—Ä–∞
uint8_t mem[1024];
IpcBufferCreateResult result = ipc_buffer_create(mem, 1024);
CHECK(IpcBufferCreateResult_is_ok(result));

// –ó–∞–ø–∏—Å—å –¥–∞–Ω–Ω—ã—Ö
int data = 42;
IpcBufferWriteResult write_result = ipc_buffer_write(result.result, &data, sizeof(data));
CHECK(IpcBufferWriteResult_is_ok(write_result));

// –ß—Ç–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö
IpcEntry entry;
IpcBufferReadResult read_result = ipc_buffer_read(result.result, &entry);
CHECK(IpcBufferReadResult_is_ok(read_result));
CHECK(entry.size == sizeof(data));
```

### **–ü—Ä–æ–¥–≤–∏–Ω—É—Ç–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ**
```cpp
// –†–µ–∑–µ—Ä–≤–∏—Ä–æ–≤–∞–Ω–∏–µ –º–µ—Å—Ç–∞
void* dest;
IpcBufferReserveEntryResult reserve = ipc_buffer_reserve_entry(buffer, size, &dest);
if (IpcBufferReserveEntryResult_is_ok(reserve)) {
    // –ó–∞–ø–∏—Å—å –≤ –∑–∞—Ä–µ–∑–µ—Ä–≤–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –º–µ—Å—Ç–æ
    memcpy(dest, data, size);
    
    // –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –∑–∞–ø–∏—Å–∏
    ipc_buffer_commit_entry(buffer, reserve.result);
}
```

## ‚ö° –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
–¢–µ—Å—Ç—ã –Ω–µ —Ñ–æ–∫—É—Å–∏—Ä—É—é—Ç—Å—è –Ω–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏, –Ω–æ –ø—Ä–æ–≤–µ—Ä—è—é—Ç:
- –ö–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å –æ–ø–µ—Ä–∞—Ü–∏–π
- –û–±—Ä–∞–±–æ—Ç–∫—É –æ—à–∏–±–æ–∫
- –ì—Ä–∞–Ω–∏—á–Ω—ã–µ —Å–ª—É—á–∞–∏
- –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—é —Ñ—É–Ω–∫—Ü–∏–π

## üîç –ö–ª—é—á–µ–≤—ã–µ –ø—Ä–æ–≤–µ—Ä–∫–∏
1. **–í–∞–ª–∏–¥–∞—Ü–∏—è –≤—Ö–æ–¥–Ω—ã—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤** - NULL —É–∫–∞–∑–∞—Ç–µ–ª–∏, –Ω–µ–≤–µ—Ä–Ω—ã–µ —Ä–∞–∑–º–µ—Ä—ã
2. **–ö–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å –æ–ø–µ—Ä–∞—Ü–∏–π** - –¥–∞–Ω–Ω—ã–µ –∑–∞–ø–∏—Å—ã–≤–∞—é—Ç—Å—è –∏ —á–∏—Ç–∞—é—Ç—Å—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ
3. **–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫** - –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –∫–æ–¥—ã –æ—à–∏–±–æ–∫ –∏ —Å–æ–æ–±—â–µ–Ω–∏—è
4. **–ì—Ä–∞–Ω–∏—á–Ω—ã–µ —Å–ª—É—á–∞–∏** - –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ —Ä–∞–∑–º–µ—Ä—ã, –ø–µ—Ä–µ–ø–æ–ª–Ω–µ–Ω–∏–µ
5. **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è** - —Ñ—É–Ω–∫—Ü–∏–∏ —Ä–∞–±–æ—Ç–∞—é—Ç –≤–º–µ—Å—Ç–µ

## üìà –†–µ–∑—É–ª—å—Ç–∞—Ç—ã
- **84 —Ç–µ—Å—Ç–∞** - –≤—Å–µ –ø—Ä–æ—Ö–æ–¥—è—Ç
- **481 assertion** - –≤—Å–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ —É—Å–ø–µ—à–Ω—ã
- **–ü–æ–ª–Ω–æ–µ –ø–æ–∫—Ä—ã—Ç–∏–µ** API –±—É—Ñ–µ—Ä–æ–≤
- **–ù–∞–¥–µ–∂–Ω–∞—è –æ—Å–Ω–æ–≤–∞** –¥–ª—è –±–æ–ª–µ–µ —Å–ª–æ–∂–Ω—ã—Ö —Ç–µ—Å—Ç–æ–≤
